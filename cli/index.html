
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../developer/">
      
      
        <link rel="next" href="../openshift_data_foundation/">
      
      
      <link rel="icon" href="../images/ocp.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.8">
    
    
      
        <title>Command Line Interface (cli) - OpenShift Introduction on IBM Z and LinuxONE</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-to-the-oc-cli" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="OpenShift Introduction on IBM Z and LinuxONE" class="md-header__button md-logo" aria-label="OpenShift Introduction on IBM Z and LinuxONE" data-md-component="logo">
      
  <img src="../images/ocp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenShift Introduction on IBM Z and LinuxONE
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Command Line Interface (cli)
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ibm-wsc/openshift-intro" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="OpenShift Introduction on IBM Z and LinuxONE" class="md-nav__button md-logo" aria-label="OpenShift Introduction on IBM Z and LinuxONE" data-md-component="logo">
      
  <img src="../images/ocp.png" alt="logo">

    </a>
    OpenShift Introduction on IBM Z and LinuxONE
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ibm-wsc/openshift-intro" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../administrator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Administrator Perspective
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Perspective
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Command Line Interface (cli)
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Command Line Interface (cli)
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#logging-in-with-the-oc-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in with the oc CLI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploring-the-oc-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Exploring the oc CLI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-oc-to-deploy-a-python-application-from-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Use oc to Deploy a Python Application from Source Code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploying-and-configuring-mongodb" class="md-nav__link">
    <span class="md-ellipsis">
      Deploying and Configuring MongoDB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#providing-sensitive-application-with-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      Providing Sensitive Application with Secrets
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../openshift_data_foundation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Persistent Storage with OpenShift Data Foundation (ODF)
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metering, Monitoring, and Alerts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../finish/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Closing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../mkdocs/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#logging-in-with-the-oc-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in with the oc CLI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploring-the-oc-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Exploring the oc CLI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-oc-to-deploy-a-python-application-from-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Use oc to Deploy a Python Application from Source Code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploying-and-configuring-mongodb" class="md-nav__link">
    <span class="md-ellipsis">
      Deploying and Configuring MongoDB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#providing-sensitive-application-with-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      Providing Sensitive Application with Secrets
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="introduction-to-the-oc-cli">Introduction to the <code>oc</code> CLI<a class="headerlink" href="#introduction-to-the-oc-cli" title="Permanent link">&para;</a></h1>
<p>The <code>oc</code> CLI is an incredibly powerful tool to manage OpenShift clusters and applications. It is capable of performing any task you can do in the web console, and some tasks are only possible to do with <code>oc</code>.</p>
<p><code>oc</code> is ideal in situations where you:</p>
<ul>
<li>Work directly with project source code.</li>
<li>Script OpenShift Container Platform operations.</li>
<li>Are restricted by bandwidth resources and cannot use the web console.</li>
</ul>
<p>Furthermore, many people familiar with Linux and/or Kubernetes tend to find the <code>oc</code> command line an easier and more efficient method of performing tasks, rather than the web-based console.</p>
<p>Like with the OpenShift web console, the OpenShift command line includes functions both <a href="https://docs.openshift.com/container-platform/4.16/cli_reference/openshift_cli/developer-cli-commands.html" rel="noopener" target="_blank">for developers</a> and for <a href="https://docs.openshift.com/container-platform/4.16/cli_reference/openshift_cli/administrator-cli-commands.html" rel="noopener" target="_blank">administrators</a>.</p>
<p>For those who are familiar with Kubernetes and its <code>kubectl</code> CLI tool, the <code>oc</code> tool is essentially analogous but with additional features.</p>
<h2 id="logging-in-with-the-oc-cli">Logging in with the <code>oc</code> CLI<a class="headerlink" href="#logging-in-with-the-oc-cli" title="Permanent link">&para;</a></h2>
<p>The frontend application, <code>parksmap</code>, needs a backend. In this section, you will deploy a python application named <code>nationalparks</code>. This application performs 2D geo-spatial queries against a MongoDB database to locate and return map coordinates of all national parks in North America.</p>
<p><strong>NOTE for those in the WSC hands-on lab session, you must complete the following steps from within the WSC linux guest. Refer to the <a href="../access/#connecting-to-openshift-via-the-cli">access.md</a> page. If you try to connect directly from the RHEL virtual machine terminal, the command will result in an error.</strong></p>
<ol>
<li>
<p>From the OpenShift web console, <strong>click your username in the top right corner</strong> (i.e. <code>Workshop User NN</code>) and select <code>Copy login command</code>.</p>
<p><img alt="copy-login-command" src="../images/copy-login-command.png" /></p>
</li>
<li>
<p><strong>Log in with your OpenShift credentials and click the Display Token hyperlink</strong>.</p>
</li>
</ol>
<p>NOTE if the copied command fails, try adding the following flag to the end of the <code>oc login command</code>:</p>
<div class="highlight"><pre><span></span><code>--insecure-skip-tls-verify
</code></pre></div>
<ol>
<li>
<p><strong>Copy the line that begins with <code>oc login</code>, paste it into a terminal session, and execute the command</strong>.</p>
<p>Sample output: </p>
<div class="highlight"><pre><span></span><code>$ oc login --token=uL3fHEPSGH3io0kljsgRfAMAPIIY44BhwnGxCMA3dei4 --server=https://api.example.com:6443
Logged into &quot;https://api.example.com:6443&quot; as &quot;user01&quot; using the token provided.

You have access to 161 projects, the list has been suppressed. You can list all projects with &#39;oc projects&#39;

Using project &quot;user01-project&quot;.
</code></pre></div>
<p>You are now logged into the cluster via the <code>oc</code> CLI, and you are told which project you are using.</p>
<p>If you’re in a project other than your own <code>userNN-project</code>, use the following command to move into it: <code>oc project userNN-project</code>, where <code>NN</code> is your user number.</p>
</li>
</ol>
<h2 id="exploring-the-oc-cli">Exploring the <code>oc</code> CLI<a class="headerlink" href="#exploring-the-oc-cli" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>In your terminal, test out the <code>oc</code> CLI</strong>.</p>
<div class="highlight"><pre><span></span><code>oc --help
</code></pre></div>
<p>Sample output: </p>
<div class="highlight"><pre><span></span><code>user01@lab061:~$ oc --help
OpenShift Client

This client helps you develop, build, deploy, and run your applications on any
OpenShift or Kubernetes cluster. It also includes the administrative
commands for managing a cluster under the &#39;adm&#39; subcommand.

Usage:
oc [flags]

Basic Commands:
login           Log in to a server
new-project     Request a new project
new-app         Create a new application
status          Show an overview of the current project
project         Switch to another project
projects        Display existing projects
explain         Documentation of resources

Build and Deploy Commands:
rollout         Manage a Kubernetes deployment or OpenShift deployment config
rollback        Revert part of an application back to a previous deployment
new-build       Create a new build configuration
start-build     Start a new build
</code></pre></div>
<p>The <code>--help</code> flag will display all of the available options the oc CLI.</p>
</li>
<li>
<p><strong>Enter the following command</strong></p>
<div class="highlight"><pre><span></span><code>oc new-app --help
</code></pre></div>
<p>Sample output:</p>
<div class="highlight"><pre><span></span><code>user01@lab061:~$ oc new-app --help
Create a new application by specifying source code, templates, and/or images

This command will try to build up the components of an application using images, templates, or code
that has a public repository. It will lookup the images on the local Docker installation (if
available), a container image registry, an integrated image stream, or stored templates.

If you specify a source code URL, it will set up a build that takes your source code and converts
it into an image that can run inside of a pod. Local source must be in a git repository that has a
remote repository that the server can see. The images will be deployed via a deployment
configuration, and a service will be connected to the first public port of the app. You may either
specify components using the various existing flags or let new-app autodetect what kind of
components you have provided.

If you provide source code, a new build will be automatically triggered. You can use &#39;oc status&#39; to
check the progress.

Usage:
oc new-app (IMAGE | IMAGESTREAM | TEMPLATE | PATH | URL ...) [flags]

Examples:
# List all local templates and image streams that can be used to create an app
oc new-app --list

# Create an application based on the source code in the current git repository (with a public
remote) and a Docker image
oc new-app . --docker-image=repo/langimage
</code></pre></div>
<p>The <code>--help</code> flag now displays all of the available options for the oc new-app command. If you get confused about any of the commands we use in this workshop, or just want more information, using this flag is a good first step.</p>
</li>
</ol>
<p><code>oc new-app</code> is a powerful and commonly used command in the OpenShift CLI. It has the ability to deploy applications from components that include:</p>
<ul>
<li>Source or binary code</li>
<li>Container images</li>
<li>Templates</li>
</ul>
<p>The set of objects created by <code>oc new-app</code> depends on the artifacts passed as an input.</p>
<h2 id="use-oc-to-deploy-a-python-application-from-source-code">Use <code>oc</code> to Deploy a Python Application from Source Code<a class="headerlink" href="#use-oc-to-deploy-a-python-application-from-source-code" title="Permanent link">&para;</a></h2>
<p>The frontend application, <code>parksmap</code>, needs a backend. In this section, you will deploy a python application named <code>nationalparks</code>. This application performs 2D geo-spatial queries against a MongoDB database to locate and return map coordinates of all national parks in North America.</p>
<ol>
<li>
<p><strong>Deploy the python backend with the following <code>oc new-app</code> command</strong>.</p>
<div class="highlight"><pre><span></span><code>oc new-app python~https://github.com/mmondics/national-parks --context-dir source/nationalparks-py --name nationalparks -l &#39;app=national-parks-app,component=nationalparks,role=backend,app.kubernetes.io/part-of=national-parks-app,app.kubernetes.io/name=python&#39;
</code></pre></div>
<p>A few things to notice about this command:</p>
<ul>
<li>The <code>oc new-app</code> command is not being run against a specific container image. It is being run against python <em>source code</em> that exists in GitHub <a href="https://github.com/mmondics/national-parks/tree/main/source/nationalparks-py" rel="noopener" target="_blank">here</a>. Although a Dockerfile exists in the directory, it is not being used due to the <code>pyhon~</code> option in the command. OpenShift is using its <em>source-to-image</em> capability to create its own Dockerfile and containerize the application from its source code. If you wanted to, you could have omitted the <code>python~</code> option and OpenShift would use the Dockerfile in the directory.</li>
<li><code>--name</code> flag provides the name for the python Deployment</li>
<li><code>-l</code> sets the following key=value pairs as labels on the deployment</li>
</ul>
<p>The output from the <code>oc new-app</code> command tells you what all was created - an imagestream, buildconfig, deployment, and service. </p>
<p>The buildconfig is the configuration file that will be used to build the <code>nationalparks</code> container image. This build will automatically begin, and you can check its logs to watch the process. </p>
</li>
<li>
<p><strong>Check the <code>nationalparks</code> build log</strong>.</p>
<div class="highlight"><pre><span></span><code>oc logs build/nationalparks-1 -f
</code></pre></div>
<p>The <code>-f</code> flag lets you follow the build logs (similar to Linux's 'tail' command). Once you see <code>Push successful</code> at the end of the build logs, your new container image has been built and pushed into OpenShift's internal registry. It will then automatically be deployed in a pod.</p>
</li>
<li>
<p><strong>Check that the <code>nationalparks</code> pod is running and ready</strong>.</p>
<div class="highlight"><pre><span></span><code>oc get pods
</code></pre></div>
<p>Sample output:</p>
<div class="highlight"><pre><span></span><code>➜  ~ oc get pods
NAME                             READY   STATUS      RESTARTS   AGE
nationalparks-1-build            0/1     Completed   0          5m19s
nationalparks-64d57bb8f8-4582b   1/1     Running     0          4m6s
parksmap-cbc66fb69-d29rn         1/1     Running     0          3m25s
parksmap-cbc66fb69-dmnf7         1/1     Running     0          3m24s
</code></pre></div>
<p>Once the <code>nationalparks</code> pod is <code>Running</code> and has <code>1/1</code> containers ready, the application is successfully deployed. However, the backend python application is only accessible from within the OCP cluster. It is not exposed to the outside world, as you may have noticed from the output of the <code>oc new-app</code> command: <code>Application is not exposed. You can expose services to the outside world by executing one or more of the commands below:</code></p>
</li>
<li>
<p><strong>Create a route that exposes the <code>nationalparks</code> service</strong>.</p>
<div class="highlight"><pre><span></span><code>oc expose service/nationalparks
</code></pre></div>
<p>It's worth understanding a little bit about what you just did. The backend application <code>nationalparks</code> runs in one pod. However, you could easily scale the number of pods running <code>nationalparks</code> up as much as you'd like, or you can let OpenShift automatically scale out the number of pods (based on CPU or memory consumption) with a <a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/" rel="noopener" target="_blank">HorizontalPodAutoscaler</a>. Each pod will be assigned its own individual IP address, and furthermore, if and when the pods regenerate, they will get brand new IP addresses. For these reasons, you cannot rely on the application's IP address in order to use it, like you would with many non-containerized applications. </p>
<p>To solve this problem, Kubernetes uses <em>services</em>. <a href="https://kubernetes.io/docs/concepts/services-networking/service/" rel="noopener" target="_blank">Services</a> are load balancers internal to the cluster that distribute requests among the application pods using label matching. If you want to access an application, you need to access the service that will then direct the request to one of the pods.</p>
<p>However, services are <strong>internal</strong> to the cluster. They allow pods to communicate with other pods inside the cluster, but not with the outside world. For external access, we need to introduce another object - <strong>routes</strong>. </p>
<p><a href="https://docs.openshift.com/container-platform/4.16/rest_api/network_apis/route-route-openshift-io-v1.html" rel="noopener" target="_blank">Routes</a> are OpenShift objects - they do not exist in upstream Kubernetes. Routes <em>expose</em> services as publicly-accessible addresses for users and applications to interact with. When you access an OpenShift appliction in a web browser, such as the <code>parksmap</code> webpage or even the OpenShift console, you navigate to that pod's route.</p>
<p><img alt="routes" src="../images/routes.png" /></p>
</li>
<li>
<p><strong>See the new route that was created</strong>.</p>
<div class="highlight"><pre><span></span><code>oc get route
</code></pre></div>
<p>Sample output:</p>
<div class="highlight"><pre><span></span><code>➜  ~ oc get routes
NAME            HOST/PORT                                        PATH   SERVICES        PORT       TERMINATION     WILDCARD
nationalparks   nationalparks-user01-project.apps.example.com          nationalparks   8080-tcp                   None
parksmap        parksmap-user01-project.apps.example.com               parksmap        8080-tcp   edge/Redirect   None
</code></pre></div>
</li>
<li>
<p><strong>Label the <code>nationalparks</code> route as the application backend</strong>.</p>
<div class="highlight"><pre><span></span><code>oc label route nationalparks type=parksmap-backend
</code></pre></div>
</li>
<li>
<p><strong>Navigate to the frontend <code>parksmap</code> route in a web browser</strong>. Use the <code>parksmap</code> <code>HOST/PORT</code> value from the <code>oc get routes</code> command preceded by <code>http://</code>.</p>
<p>For example: <code>http://parksmap-userNN-project.apps.example.com</code></p>
<p>Alternatively, you can click the small arrow button associated with the <code>parksmap</code> deployment in the OpenShift web console topology.</p>
<p><img alt="topology-route" src="../images/topology-route.png" /></p>
<p>Any way that you get there, your application should display the image below:</p>
<p><img alt="parksmap-empty" src="../images/parksmap-empty.png" /></p>
<p>You should see a map of the world, but you will not see any icons for National Parks yet. That's because we have one more application to deploy and configure - the MongoDB database that will store all of the data about National Parks and their locations.</p>
</li>
</ol>
<h2 id="deploying-and-configuring-mongodb">Deploying and Configuring MongoDB<a class="headerlink" href="#deploying-and-configuring-mongodb" title="Permanent link">&para;</a></h2>
<p>The MongoDB you will deploy in this section will store all information about the National Parks, their names and coordinates.</p>
<ol>
<li>
<p><strong>Deploy the MongoDB container</strong>.</p>
<div class="highlight"><pre><span></span><code>oc new-app quay.io/mmondics/mongodb:latest --name mongodb-nationalparks -e MONGODB_USER=mongodb -e MONGODB_PASSWORD=mongodb -e MONGODB_DATABASE=mongodb -e MONGODB_ADMIN_PASSWORD=mongodb -l &#39;app.kubernetes.io/part-of=national-parks-app,app.kubernetes.io/name=mongodb&#39;
</code></pre></div>
<p>A few things to notice about this command:</p>
<ul>
<li>You're deploying a pre-built container image hosted at <quay.io/mmondics/mongodb>. </li>
<li><code>--name</code> sets the name of the MongoDB deployment</li>
<li><code>-e</code> sets environment variables within the resulting container. These can be used like any other environment variable when the container is running, and you can see them by connecting to the pod and running the <code>env</code> command</li>
<li><code>-l</code> sets labels for this deployment</li>
</ul>
</li>
<li>
<p>In a later step, you will be adding persistent storage to this MongoDB deployment. Mounting storage requires a certain securityContext, so in preparation, <strong>please run the following command to add the proper securityContext</strong>.</p>
<div class="highlight"><pre><span></span><code>oc patch deployment mongodb-nationalparks --type=&#39;json&#39; -p=&#39;[{&quot;op&quot;:&quot;add&quot;,&quot;path&quot;:&quot;/spec/template/spec/securityContext&quot;,&quot;value&quot;:{&quot;fsGroup&quot;:184,&quot;runAsGroup&quot;:184,&quot;runAsUser&quot;:184}}]&#39;
</code></pre></div>
<p>Once again, you can check <code>oc get pods</code> to see when the MongoDB pod is ready.</p>
<div class="highlight"><pre><span></span><code>NAME                                     READY   STATUS      RESTARTS   AGE
mongodb-nationalparks-5d8b6f99f7-4wwst   1/1     Running     0          8s
nationalparks-1-build                    0/1     Completed   0          58m
nationalparks-67b69fc9b7-z5znq           1/1     Running     0          56m
parksmap-cbc66fb69-c87k7                 1/1     Running     0          39m
</code></pre></div>
<p>Now, you may think that you are ready to look at your frontend application again to see the backend data. However, this MongoDB requires authentication before it can be used, so in the next section, you will provide sensitive information to the application using OpenShift <em>secrets</em>.</p>
</li>
</ol>
<h2 id="providing-sensitive-application-with-secrets">Providing Sensitive Application with Secrets<a class="headerlink" href="#providing-sensitive-application-with-secrets" title="Permanent link">&para;</a></h2>
<p>The <em>Secret</em> object provides a mechanism to hold sensitive information such as passwords, OpenShift Container Platform client configuration files, private source repository credentials, and so on. Secrets decouple sensitive content from the pods. You can mount secrets into containers using a volume plugin or the system can use secrets to perform actions on behalf of a pod. By default, secrets are stored <em>unencrypted</em> in etcd. Therefore secrets are securable by default, not secured. To safely secure secrets, you must turn on etcd encryption as well as configure proper role-based access controls to the secret objects and etcd. Read more about secrets <a href="https://kubernetes.io/docs/concepts/configuration/secret/">here</a>.</p>
<p>The following procedure adds the secret <code>nationalparks-mongodb-parameters</code> and mounts it to the <code>nationalparks</code> workload.</p>
<ol>
<li>
<p><strong>Create a secret holding sensitive information</strong> (usernames and passwords).</p>
<div class="highlight"><pre><span></span><code>oc create secret generic nationalparks-mongodb-parameters --from-literal=DATABASE_SERVICE_NAME=mongodb-nationalparks --from-literal=MONGODB_USER=mongodb --from-literal=MONGODB_PASSWORD=mongodb --from-literal=MONGODB_DATABASE=mongodb --from-literal=MONGODB_ADMIN_PASSWORD=mongodb
</code></pre></div>
</li>
<li>
<p><strong>Update the environment variable to attach the <code>nationalparks-mongodb-parameters</code> secret to the <code>nationalparks</code> workload</strong>.</p>
<div class="highlight"><pre><span></span><code>oc set env --from=secret/nationalparks-mongodb-parameters deploy/nationalparks
</code></pre></div>
<p>The <code>nationalparks</code> deployment will notice that a change has been made, and it will create a new pod with these changes applied. Check with <code>oc get pods</code> until the new pod is up and running.</p>
</li>
<li>
<p>Once the <code>mongodb-nationalparks</code> pod is running and ready, <strong>run the following command to load National Park data into MongoDB</strong>.</p>
<p><strong>Make sure that you are in your own project before running the command.</strong></p>
<div class="highlight"><pre><span></span><code>oc exec $(oc get pods -l component=nationalparks | tail -n 1 | awk &#39;{print $1;}&#39;) -- curl -s http://localhost:8080/ws/data/load
</code></pre></div>
<p>If you see <code>"Items inserted in database: 204"</code>, the data was successfully loaded.</p>
</li>
<li>
<p>Finally, <strong>return to your frontend <code>parksmap</code> application in a web browser</strong>.</p>
<p><img alt="parksmap-loaded" src="../images/parksmap-loaded.png" /></p>
</li>
</ol>
<p>This interactive map is the culmination of all the Kubernetes and OpenShift objects that you created throughout the course of this tutorial. You can click on each icon on the map to see more details about each National Park.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../developer/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Developer Perspective">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Developer Perspective
              </div>
            </div>
          </a>
        
        
          
          <a href="../openshift_data_foundation/" class="md-footer__link md-footer__link--next" aria-label="Next: Persistent Storage with OpenShift Data Foundation (ODF)">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Persistent Storage with OpenShift Data Foundation (ODF)
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ibm-wsc/openshift-intro" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "navigation.sections", "navigation.expand", "navigation.top", "navigation.tracking", "navigation.footer", "search.share", "navigation.indexes", "announce.dismiss", "content.tabs.link", "content.code.copy", "content.action.edit", "content.action.view"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>